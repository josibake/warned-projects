#!/bin/bash

# Function to display usage
show_usage() {
    echo "Usage: $0 <network_directory>"
    echo "Example: $0 networks/all_same_version/"
}

# Check if an argument is provided
if [ $# -eq 0 ]; then
    echo "Error: No network directory specified."
    show_usage
    exit 1
fi

# Assign the first argument to a variable
network_dir="$1"

# Check if the provided directory exists
if [ ! -d "$network_dir" ]; then
    echo "Error: The specified network directory does not exist."
    show_usage
    exit 1
fi

# Main script
warnet deploy "$network_dir"
warnet bitcoin rpc miner createwallet miner
warnet bitcoin rpc miner importdescriptors '["{\"desc\":\"wpkh(tprv8ZgxMBicQKsPfH87iaMtrpzTkWiyFDW7SVWqfsKAhtyEBEqMV6ctPdtc5pNrb2FpSmPcDe8NrxEouUnWj1ud7LT1X1hB1XHKAgB2Z5Z4u2s/84h/1h/0h/0/*)#5j6mshps\",\"timestamp\":0,\"active\":true,\"internal\":false,\"range\":[0,999],\"next\":0,\"next_index\":0}","{\"desc\":\"wpkh(tprv8ZgxMBicQKsPfH87iaMtrpzTkWiyFDW7SVWqfsKAhtyEBEqMV6ctPdtc5pNrb2FpSmPcDe8NrxEouUnWj1ud7LT1X1hB1XHKAgB2Z5Z4u2s/84h/1h/0h/1/*)#9xl6dz3g\",\"timestamp\":0,\"active\":true,\"internal\":true,\"range\":[0,999],\"next\":0,\"next_index\":0}"]'
warnet run scenarios/signet_miner.py --tank=0 generate --min-nbits --address=tb1q6vakuyw2jhzwmnxcaxryxs6c670fr9esfvrrhj
